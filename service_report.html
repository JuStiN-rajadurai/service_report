<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Service Reports â€“ Firestore</title>

<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<style>
body { background:#f5f7fb; }
.card { border:none; border-radius:15px; box-shadow:0 5px 20px rgba(0,0,0,.08); }
.badge-pill { border-radius:20px; padding:5px 15px; }
</style>
</head>

<body>

<div class="container py-4">

<div class="d-flex justify-content-between align-items-center mb-4">
<h3 class="text-primary">
<i class="bi bi-database"></i> Service Reports (Firestore)
</h3>
<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addModal">
<i class="bi bi-plus-circle"></i> Add Report
</button>
</div>

<!-- Loader -->
<div id="loading" class="text-center py-5">
<div class="spinner-border text-primary"></div>
<p class="mt-2">Loading data...</p>
</div>

<!-- Table -->
<div id="reportsTable" class="card d-none">
<div class="card-body p-0">
<div class="table-responsive">
<table class="table table-hover mb-0">
<thead class="table-light">
<tr>
<th>#</th>
<th>Client</th>
<th>Service</th>
<th>Date</th>
<th>Status</th>
<th>Paid</th>
<th>Remarks</th>
</tr>
</thead>
<tbody id="tableBody"></tbody>
</table>
</div>
</div>
</div>

</div>

<!-- ADD MODAL -->
<div class="modal fade" id="addModal">
<div class="modal-dialog modal-lg">
<div class="modal-content">
<div class="modal-header bg-primary text-white">
<h5>Add Service Report</h5>
<button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
</div>

<div class="modal-body">
<form id="reportForm">
<div class="row g-3">

<div class="col-md-6">
<label>Client</label>
<input type="text" id="clientName" class="form-control" required>
</div>

<div class="col-md-6">
<label>Service</label>
<select id="serviceType" class="form-select" required>
<option value="">Select</option>
<option>Website Development</option>
<option>SEO</option>
<option>Social Media</option>
<option>Maintenance</option>
</select>
</div>

<div class="col-md-4">
<label>Date</label>
<input type="date" id="reportDate" class="form-control" required>
</div>

<div class="col-md-4">
<label>Status</label>
<select id="reportStatus" class="form-select">
<option>Pending</option>
<option>In Progress</option>
<option>Completed</option>
</select>
</div>

<div class="col-md-4">
<label>Payment</label>
<select id="paidStatus" class="form-select">
<option>Paid</option>
<option>Un Paid</option>
</select>
</div>

<div class="col-12">
<label>Remarks</label>
<textarea id="remarks" class="form-control"></textarea>
</div>

</div>
</form>
</div>

<div class="modal-footer">
<button class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
<button class="btn btn-primary" onclick="saveReport()">
<i class="bi bi-cloud-arrow-up"></i> Save
</button>
</div>

</div>
</div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- FIREBASE -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import {
getFirestore,
collection,
addDoc,
getDocs,
query,
orderBy
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* ðŸ”¥ REPLACE WITH YOUR FIREBASE CONFIG */
const firebaseConfig = {
apiKey: "AIzaSyAkc1evwPeKQeQdzADPeXW6eEsArWKPmzg",
authDomain: "jstn-service-reports.firebaseapp.com",
projectId: "jstn-service-reports",
storageBucket: "jstn-service-reports.firebasestorage.app",
messagingSenderId: "631641002286",
appId: "1:631641002286:web:006f522cb4dc6a720a6abf"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* SAVE REPORT */
window.saveReport = async function () {
await addDoc(collection(db, "service_reports"), {
client: clientName.value,
service: serviceType.value,
date: reportDate.value,
status: reportStatus.value,
paid: paidStatus.value,
remarks: remarks.value,
createdAt: new Date()
});

bootstrap.Modal.getInstance(addModal).hide();
reportForm.reset();
loadReports();
};

/* LOAD REPORTS */
window.loadReports = async function () {
tableBody.innerHTML = "";
const q = query(collection(db, "service_reports"), orderBy("createdAt", "desc"));
const snap = await getDocs(q);

loading.style.display = "none";
reportsTable.classList.remove("d-none");

let i = 1;
snap.forEach(doc => {
const r = doc.data();
tableBody.innerHTML += `
<tr>
<td>${i++}</td>
<td>${r.client}</td>
<td>${r.service}</td>
<td>${r.date}</td>
<td>${r.status}</td>
<td>${r.paid}</td>
<td>${r.remarks || "-"}</td>
</tr>`;
});
};

document.addEventListener("DOMContentLoaded", loadReports);
</script>

</body>
</html>
